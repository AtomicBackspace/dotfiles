[[rule]]
toolName = "run_shell_command"
commandPrefix = ["gatekeeper", "/usr/local/bin/gatekeeper"]
decision = "allow"
priority = 390

[[rule]]
toolName = "run_shell_command"
commandRegex = ".*git\\s+commit.*(--no-verify|-n\\b).*"
decision = "deny"
priority = 900
deny_message = "SECURITY POLICY: Bypassing git hooks with --no-verify is strictly prohibited."

[[rule]]
toolName = ["write_file", "replace"]
argsPattern = ".*file_path.*(\\.gatekeeper\\.yaml|\\.golangci\\.yml|\\.gemini/settings\\.json).*"
decision = "deny"
priority = 910
deny_message = "SECURITY POLICY: Modifying compliance configuration files is prohibited. Use ask_user and provide suggested update."

[[rule]]
toolName = "run_shell_command"
commandRegex = ".*(rm|mv|cp|echo|cat).*\\.git/hooks/pre-commit.*"
decision = "deny"
priority = 920
deny_message = "SECURITY POLICY: Tampering with git hooks is prohibited."

[[rule]]
toolName = "run_shell_command"
commandRegex = ".*git\\s+config.*core\\.hooksPath.*"
decision = "deny"
priority = 930
deny_message = "SECURITY POLICY: Overriding the system-wide git hooks path is prohibited."

[[rule]]
toolName = "run_shell_command"
commandRegex = ".*(/usr/bin/git|/bin/git).*"
decision = "deny"
priority = 940
deny_message = "SECURITY POLICY: Bypassing the Git wrapper by calling the binary directly is prohibited."
